# CVEList5 Parser

This project contains a Python script (`parse_cve5.py`) to parse CVE JSON data (prioritizes CNA over ADP data for the output). The script is designed to process CVE records obtained from the official CVE List repository on GitHub, specifically [CVEListV5](https://github.com/CVEProject/cvelistV5). The script can process single CVE JSON files or entire directories containing them.

## Setup

1.  Clone the repository.
2.  Ensure you have Python and `uv` installed.
3.  Install dependencies, including development dependencies for testing:

    ```bash
    uv sync
    ```

## Running

To run the script, provide the path to a CVE JSON file as a command-line argument:

```bash
python parse_cve5.py /path/to/your/cve_file.json
```

The script will parse the data and print the structured output to the console.

It also supports saving the output to a file using the `-o` or `--output` flag.

## Usage

To run the script and print the output to the console for a single file:

```bash
python parse_cve5.py /path/to/your/cve_file.json
```

To run the script and print the output to the console for all JSON files in a directory:

```bash
python parse_cve5.py /path/to/your/cve_directory/
```

To run the script and save the output to a specific file for a single input file:

```bash
python parse_cve5.py /path/to/your/cve_file.json -o output_parsed.json
```

To run the script and save the output to default-named files (e.g., `cve_file_parsed.json`) within a specified output directory when processing an input directory:

```bash
python parse_cve5.py /path/to/your/cve_directory/ -o /path/to/output/directory/
```

To run the script and save the output to a default-named file (e.g., `cve_file_parsed.json`) in the current directory for a single input file:

```bash
python parse_cve5.py /path/to/your/cve_file.json -o
```

To run the script and save the output to default-named files (e.g., `original_file_parsed.json`) in the current directory when processing an input directory:

```bash
python parse_cve5.py /path/to/your/cve_directory/ -o .
```

## Expected Output Structure

The script outputs JSON data with the following structure:

```json
{
    "cve_id": "CVE-XXXX-XXXX",
    "title": "Sample Vulnerability Title",
    "assigner": "CNA",
    "published_date": "YYYY-MM-DDTHH:MM:SS.sssZ",
    "last_modified_date": "YYYY-MM-DDTHH:MM:SS.sssZ",
    "description": "A brief description of the vulnerability.",
    "remediation": {
        "solution": "Possible solution or fix.",
        "workaround": "Possible workaround."
    },
    "cwe_ids": [
        "CWE-XXX"
    ],
    "cvss": {
        "version": "X.Y",
        "vector_string": "CVSS:X.Y/A:B/C:D...",
        "base_score": X.Y,
        "severity": "SEVERITY"
    },
    "ssvc_status": {
        "key": "value"
    },
    "affected_products": [
        {
            "vendor": "Vendor Name",
            "product": "Product Name",
            "platforms": ["Platform 1", "Platform 2"],
            "versions": [
                "1.0",
                "2.0 (< 2.1)",
                "3.0 (<= 3.5)"
            ]
        }
    ],
    "references": [
        "http://example.com/reference"
    ],
    "exploit_references": [],
    "cisa_kev": {}
}
```

## Samples

Example input CVE JSON files can be found in the `./sample_json_cve` directory. Parsed output files generated by the script can be found in the `./parsed_outputs` directory when running the script on the sample files with the output flag.
